# 環境変数オプション追加機能の要件

## 概要
editpromptコマンドに環境変数を設定できる`--env`オプションを追加し、エディタ起動時に特定の環境変数を設定できるようにする。

## 機能要件

### 1. --envオプションの追加
- コマンドラインに`--env`オプションを追加する
- 複数の環境変数を設定できるようにする
  - 例: `editprompt --env A=a --env B=b`
- 環境変数の形式は`KEY=VALUE`とする

### 2. エディタ起動時の環境変数設定
- `--env`で指定された環境変数をエディタプロセスに渡す
- Node.jsの`spawn`や`exec`で環境変数を設定する仕組みを使用する

### 3. EDITPROMPT環境変数の自動付与
- エディタ起動時に必ず`EDITPROMPT=1`を環境変数として設定する
- ユーザーが`--env`で指定した環境変数と併せて設定する
- これにより、エディタ側でeditpromptから起動されたことを検知できる

## 動作例

### 基本的な使用例
```bash
# 環境変数A=aを設定してエディタを起動
editprompt --env A=a

# 複数の環境変数を設定
editprompt --env A=a --env B=b --env C=c

# 他のオプションと併用
editprompt --env CUSTOM=value --editor nvim
```

### 実際のプロセス起動
```bash
# ユーザーが実行
editprompt --env FOO=bar

# 内部的に実行されるプロセス
EDITPROMPT=1 FOO=bar nvim /tmp/editprompt-xxx.md
```

## 技術的要件

### 1. CLIオプションのパース
- gunshiフレームワークを使用して`--env`オプションをパースする
- 複数の`--env`指定を配列として受け取る

### 2. エディタモジュールの改修
- `src/modules/editor.ts`の`launchEditor`関数を改修
- 環境変数を設定してプロセスを起動する機能を追加

### 3. 後方互換性
- 既存の`--editor`オプションの動作は変更しない
- `--env`オプションは省略可能とする

## 制約事項

1. 環境変数名は有効なシェル変数名の規則に従う
2. 環境変数の値にスペースが含まれる場合は適切にエスケープする必要がある
3. システムの環境変数と重複する場合は、指定した値で上書きする