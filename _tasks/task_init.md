# タスク
「CLIツールの要件定義をまとめる」のタスクを整理するためのチェックリストです。
チェックリストを作成したりタスクが増えたら、ユーザーの指示がなくても編集してください。
チェックリストのタスクが完了したらユーザーの指示がなくても編集してください。

## やりたいこと

Claude Codeの入力を便利にするためのCLIツールをTypeScriptを使って開発しようと思ってます。

- `ccsender`(グローバルインストール)または`npx ccsender`というコマンドを実行すると、環境変数`$EDITOR`に入力したエディタが開きます(一時ファイルのMarkdownを開く)
    - イメージはzshの`zle -N edit-command-line`のやつみたいな感じ
- そのエディタを終了したら、作成した一時ファイルの内容を取得する(プロンプト)
- プロセスから`claude`コマンドを探す
    - claudeがなければ`cat プロンプト | claude`で起動
    - claudeのプロセスが1つだけなら、そのプロセスの標準入力として送る
    - claudeのプロセスが複数なら選択UIを出してどのプロセスか決める
        - それぞれのプロセスのディレクトリや起動日時などを表示する
- 実装やドキュメントは全部英語
- 技術詳細
    - 言語: TypeScript
    - Linter・Formatter: Biome
    - CLIライブラリ: [Gunshi](https://gunshi.dev/)
    - ビルド: tsdown
    - CLIの選択UIライブラリ: inquirer

## チェックリスト

`A: `のようにアルファベットのラベルをつけることで、参照しやすくする

### 1. 要件定義の確認と不足情報の整理

- [x] A: 要件定義の不足情報をチェックリストに追加
- [x] B: エラーハンドリングの詳細を決める
    - エディタ起動失敗: エラーメッセージ表示して終了
    - claudeプロセスなし: `cat プロンプト | claude`で新規起動
    - 標準入力送信失敗: クリップボードにコピーしてエラー表示
- [x] C: プロセス検索の具体的な実装方法を決める
    - find-processライブラリを使用
    - /proc/プロセスID/cwdで実行ディレクトリを取得
    - 選択UIにディレクトリ情報を表示
- [x] D: エディタ起動時のファイル名・初期内容を決める
    - ファイル名: `.ccinput-YYYYMMDDHHMMSS.md`（日時形式）
    - 初期内容: 空
    - エディタ終了後: ファイルは削除しない
- [x] E: CLIのオプション（ヘルプ、バージョン等）を決める
    - `--help/-h`: ヘルプ表示
    - `--version/-v`: バージョン表示
    - `--editor/-e`: 使用するエディタを指定（$EDITORより優先）
- [x] F: パッケージング・配布方法を決める
    - npm registryに公開
    - パッケージ名: `ccsender`
    - ライセンス: MIT
- [x] G: テスト戦略を決める
    - パッケージマネージャー: Bun
    - テストランナー: Bunのテスト機能を使用
    - モック対象: エディタ起動、プロセス検索等
- [x] H: CI/CDの設定を決める
    - 後回しにする

### 2. プロジェクトセットアップ

- [x] A: リポジトリ名をclaude-inputterからccsenderに変更
- [x] B: pnpmからBunに移行（package-lock削除、bun install実行）
- [x] C: プロジェクト構造の作成
- [x] D: 必要なパッケージのインストール
- [x] E: TypeScript設定
- [x] F: Biome設定
- [x] G: tsdown設定
- [x] H: package.jsonの設定（bin設定含む）

### 3. コア機能の実装

- [x] A: エディタ起動モジュール（一時ファイル作成・起動・内容取得）
- [x] B: プロセス検索モジュール（claudeプロセスの検出）
- [x] C: プロセス選択UI（複数プロセス時の選択）
- [x] D: 標準入力送信モジュール
- [x] E: メインCLIエントリーポイント

### 4. テストとドキュメント

- [x] A: ユニットテストの作成
- [x] B: 統合テストの作成
- [x] C: README.mdの作成
- [x] D: コマンドヘルプの実装

### 5. パッケージングとリリース

- [ ] A: npm publishの準備
- [ ] B: CI/CDの設定（後回し）
- [ ] C: 初回リリース
